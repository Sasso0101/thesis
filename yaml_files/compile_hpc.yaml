sequential: true

variables:
  ncpus: [1, 2, 4, 8, 16, 24]
  chunksize: [16, 32, 64, 256, 1024, 4096]
  implname: ["atomic"]

command: "module load cmake-3.15.4 && make clean && CHUNK_SIZE={chunksize} MAX_THREADS={ncpus} make -j24 bin/bfs && mkdir -p targets && mv bin/bfs targets/bfs_{implname}_chunksize{chunksize}_{ncpus}cpus && echo \"Built: targets/bfs_{implname}_chunksize{chunksize}_{ncpus}cpus\" || echo \"Something went wrong\""

jobs:
  - config: "hpc_24cpus"
    config_jobs:
      - tag: "compile"
